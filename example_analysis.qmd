---
title: "Example Analysis: UFO Sightings"
bibliography: references.bib
csl: biostatistics.csl
---

::: {#fig-ufo}
![](https://www.denverpost.com/wp-content/uploads/2017/12/ap17357198852063.jpg?w=780)

James Quigg/The Daily Press, via Associated Press and [The Denver Post](https://www.denverpost.com/2017/12/23/ufo-sighting-california-spacex/){target="\"_blank:"} (Dec 22, 2017)
:::

## Motivation and questions

In a 2021 [article](https://www.nytimes.com/2021/04/09/nyregion/ufo-sightings-recent.html){.external target="_blank"}, Sarah Maslin Nir at the New York Times reported an increase in UFO sightings over the pandemic, especially in New York state. Several possible causes were identified, including more time spent home, lower light pollution, and urban residents moving to rural areas, especially during the start of the pandemic in early 2020 [@nir2021].

I found this intriguing, and wanted to replicate these findings with more recent data to see whether UFO sightings continue to be elevated. I also wanted to explore whether increased UFO sightings were reported across the United States (or were a localized New York event).

::: callout-note
This is an assignment for my statistical computing course. I am not a subject matter expert, and all analyses are for demonstration purposes only.
:::

My questions for this analysis are:

-   Have UFO sightings increased in 2020-2021, and has the increase continued into later years?
-   How is the change in UFO sightings spatially distributed?

## Intended audience

The intended audience is the general public, especially UFO enthusiasts.

::: callout-important
## An important message

If the Pentagon are reading this and [you are hiring](https://thehill.com/policy/defense/4300252-pentagon-ufo-chief-to-step-down-next-month/){.external target="_blank"}: I am open for work.
:::

## Data source and dictionary

The datasets used in this analysis come from the 06/20/2023 Tidy Tuesday [GitHub repository](https://github.com/rfordatascience/tidytuesday/tree/master/data/2023/2023-06-20){.external target="_blank"}. Original data comes from the [National UFO Reporting Center](https://nuforc.org/ndx/?id=shape){.external target="_blank"}.

I will be using the `ufo_sightings` and `places` datasets, whose data dictionaries can be found [here](https://github.com/rfordatascience/tidytuesday/tree/master/data/2023/2023-06-20#data-dictionary){.external target="_blank"}.

## Data import and cleaning

First, to import the datasets:

```{r}
#| warning: false

# load needed packages
library(tidyverse)
library(tidytuesdayR)
library(here)
library(usmap)
library(sp)
library(BAMMtools)
library(scales)

# load datasets
if (!file.exists(here("data", "ufo_sightings.RDS"))) {
    ufo_sightings <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-06-20/ufo_sightings.csv')
    places <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-06-20/places.csv')

    # save the files to RDS objects
    saveRDS(ufo_sightings, file = here("data", "ufo_sightings.RDS"))
    saveRDS(places, file = here("data", "places.RDS"))
}

raw_ufo_sightings <- readRDS(here("data", "ufo_sightings.RDS"))
raw_places <- readRDS(here("data", "places.RDS"))

glimpse(raw_ufo_sightings)
glimpse(raw_places)
```

Then, to clean and wrangle the `places` dataset. These are fairly clean+tidy datasets already, so there isn't much to do:

```{r}
places <- raw_places %>% 
  select(city, state, country_code, latitude, longitude) %>% 
  filter(country_code == "US")
```

Note that the place names can vary in capitalization (e.g. Yukon, OK on the right table), so I'll standardize and remove duplicates:

```{r}
#| column: margin
# ex. Yukon, OK has three entries:
places %>% 
  filter(str_detect(city, regex("yukon", ignore_case = TRUE))) %>% 
  knitr::kable()
```

```{r}
# standardize capitalizations
places <- places %>% 
  mutate(city = str_to_title(city)) %>% 
  distinct()
```

Next, to wrangle the `ufo_sightings` dataset, I'll remove the time information and keep observations from 2018 on (to give us \~2 years before and after the pandemic). Then, I'll add in latitude/longitude data from `places`.

```{r}
ufo_sightings <- raw_ufo_sightings %>% 
  select(reported_date_time_utc, city, state, country_code) %>%
  mutate(
    date = as_date(reported_date_time_utc),
    city = str_to_title(city)
  ) %>% 
  filter(country_code == "US", date > "2018-01-01") %>% 
  # add lat/long from places
  left_join(places, by = join_by(city, state, country_code)) %>% 
  select(-reported_date_time_utc) %>% 
  relocate(date)

# look at our dataset
head(ufo_sightings)
```

## Changes in sightings during pandemic

Now that we have our final dataset, let's look at the change in sightings over the pandemic.

Since the NYTimes article cited people staying at home as one of the reasons that UFO sightings increased, I've chosen to highlight the period of decreased mobility in the US as described by Elarde et al., who estimated that time spent in public places sharply decreased in March 2020 and returned to pre-pandemic levels by June 2020 [@elarde2021].

First, I plotted UFO sighting count by day:

```{r}
ufo_sightings %>%
  group_by(date) %>% 
  summarize(
    count = n()
  ) %>% 
  ggplot(mapping = aes(x = date, y = count)) +
    annotate("rect", 
             xmin = ymd("2020-03-01"), 
             xmax = ymd("2020-06-01"), 
             ymin = -Inf, 
             ymax = Inf,
             fill = "orange",
             alpha = 0.5) +
    annotate("text",
             x = ymd("2020-06-15"), 
             y = 65,
             hjust = 0,
             label = "Decreased mobility \nduring pandemic \nMar-May, 2020",
             color = "darkorange",
             size = 10/.pt) +
    geom_point(size = 0.5) +
    geom_smooth() +
    theme_classic() +
    labs(
      title = "Daily UFO sighting counts in the US (2018-2023)",
      subtitle = "Sightings increased over 2019 and peaked in early 2020 just before pandemic;\nElevated sighting counts were not sustained past 2020",
      x = "Date",
      y = "Daily UFO sighting count",
      caption = "Data from National UFO Reporting Center"
    )
```

SOME ANALYSIS HERE

The sighting counts by day are quite noisy, so I also plotted UFO sighting count by month:

```{r}
# by month:
ufo_sightings %>% 
  # taking floor to extract month
  # shift by half month so bars are centered on middle of the month
  mutate(month = floor_date(date, "months") + 15) %>% 
  group_by(month) %>% 
  summarize(
    count = n()
  ) %>% 
  mutate(period = factor(ifelse(month %within% interval(ymd("2020-03-01"), ymd("2020-06-01")), "highlight", "normal"))) %>% 
  ggplot(mapping = aes(x = month, y = count, fill = period)) +
    geom_bar(stat = "identity") +
    scale_fill_manual(values = c("orange", "grey50")) +
    annotate("text",
             x = ymd("2020-06-05"), 
             y = 600,
             hjust = 0,
             label = "Decreased mobility \nduring pandemic \nMar-May, 2020",
             color = "darkorange",
             size = 10/.pt) +
    theme_classic() +
    theme(legend.position = "none") +
    labs(
      title = "Monthly UFO sighting counts in the US (2018-2023)",
      subtitle = "Monthly sightings sharply increased during start of pandemic (Mar/Apr 2020)",
      x = "Date",
      y = "Monthly UFO sighting count",
      caption = "Data from National UFO Reporting Center"
    )
    
```

From the monthly plot, we can see that indeed, the first two months of restricted movement in the pandemic (March and April, 2020) have much higher UFO sighting counts compared to January and February, 2020.

We'll use that 4-month time span of Jan-Apr 2020 to look at the geographic distribution of the change in sightings.

## Geographic distribution of change in sightings

First, I'll filter the data to include only reports from Jan-Apr 2020:
```{r}
pandemic_sightings<- ufo_sightings %>% 
  filter(date %within% interval(ymd("2020-01-01"), ymd("2020-04-30"))) %>% 
  mutate(
    time_period = case_when(date < "2020-03-01" ~ "before", .default = "after") %>% 
                  factor(levels = c("before", "after"))
    )
  
```

```{r}
#| fig-width: 10
transformed_sightings <- usmap_transform(pandemic_sightings, input_names = c("longitude", "latitude")) %>% 
  mutate(time_period = fct_recode(time_period, `Jan-Feb 2020` = "before", `Mar-Apr 2020` = "after"))

plot_usmap() +
  geom_point(transformed_sightings, mapping = aes(x, y, color = time_period), size = 0.5) +
  facet_wrap(~time_period) +
  theme_minimal() +
  theme(
    legend.position = "none",
    axis.line = element_blank(),
    axis.title = element_blank(),
    axis.text = element_blank(),
    panel.grid = element_blank()) +
  labs(
    title = "UFO sightings before and during pandemic stay-at-home orders in US",
    subtitle = "The West Coast and Midwest experienced the greatest increase in UFO sightings",
    caption = "Data from National UFO Reporting Center"
  )

```

While it's a bit hard to tell from the maps above, it looks like there was an increase in sightings in the Midwest and West Coast regions of the US. Let's look at the change in sightings by state:

```{r}
diff_sightings <- pandemic_sightings %>% 
  group_by(state, time_period) %>% 
  count() %>% 
  pivot_wider(names_from = time_period, values_from = n) %>% 
  mutate(
    abs_diff = after - before,
    perc_diff = abs_diff / before,
    fips = fips(state)
  ) %>% 
  select(state, fips, abs_diff, perc_diff)
```

```{r}
#| fig-cap: Change in UFO sightings before vs. during pandemic by US state
#| fig-subcap: 
#|     - "Absolute change"
#|     - "Percent change"
#| layout-ncol: 2

# Using Jenks natural breaks to change color scale
# I feel this makes the scale more readable, especially since 
abs_scale <- getJenksBreaks(diff_sightings$abs_diff, 7) %>% rescale(to = c(0,1))
perc_scale <- getJenksBreaks(diff_sightings$perc_diff, 7) %>% rescale(to = c(0,1))

plot_usmap(data = diff_sightings, values = "abs_diff") +
  scale_fill_distiller(palette = "BrBG", direction = 1, values = abs_scale) +
  labs(
    fill = "Change in \nsightings"
  )

plot_usmap(data = diff_sightings, values = "perc_diff") +
  scale_fill_distiller(palette = "PiYG", direction = 1, values = perc_scale, labels = scales::label_percent()) +
  labs(
    fill = "% change \nin sightings"
  )

```


## Summary

## Functions used

**dplyr**: `select`, `filter`, `mutate`, `distinct`, `left_join`, `relocate`, `pivot_wider`

**ggplot2 geom\_**: `geom_point`, `geom_bar`, `geom_smooth`

## References

::: {#refs}
:::
